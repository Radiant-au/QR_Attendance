# Project Architecture: QR Attendance System

This document outlines the architecture of the QR Attendance System backend. The application is built with Node.js, Express, TypeScript, and TypeORM.

## Directory Structure

The `src` directory contains the core application logic, organized into the following subdirectories:

-   **`config`**: Contains configuration files for the application, such as database connection settings (`data-source.ts`) and environment variables (`env.ts`).
-   **`controllers`**: Contains controller classes that handle incoming HTTP requests. Controllers are responsible for parsing request data, calling the appropriate service methods, and sending a response to the client.
-   **`dto`**: (Data Transfer Objects) Contains classes that define the shape of data sent to and from the application's API. DTOs are used for data validation and transformation.
-   **`entities`**: Contains TypeORM entity classes that map to database tables. These classes define the application's data model.
-   **`middlewares`**: Contains Express middleware functions, such as authentication, error handling, and request validation.
-   **`migrations`**: Contains database migration files generated by TypeORM.
-   **`repositories`**: Contains TypeORM repositories for each entity. Repositories provide a high-level API for database operations.
-   **`routes`**: Contains Express router modules that define the application's API endpoints.
-   **`scripts`**: Contains scripts for various tasks, such as seeding the database with initial data.
-   **`services`**: Contains service classes that implement the application's business logic. Services are called by controllers and use repositories to interact with the database.
-   **`utils`**: Contains utility functions and classes used throughout the application, such as custom error classes and hashing functions.

## Application Flow

The application follows a typical layered architecture. A request from a client flows through the application as follows:

1.  **`src/index.ts`**: The application's entry point. It initializes the Express server, sets up middleware, and mounts the main API router.
2.  **`src/routes/index.ts`**: The main router, which delegates requests to feature-specific routers based on the URL path.
3.  **`src/routes/*.ts`**: Feature-specific routers that define the API endpoints for a particular resource (e.g., `/api/activity`). These routers map HTTP methods and URL paths to controller methods.
4.  **`src/controllers/*.ts`**: Controller methods are executed when a matching request is received. They extract data from the request (e.g., body, params, query), and call the appropriate service method to handle the request.
5.  **`src/services/*.ts`**: Service methods contain the core business logic of the application. They process the data, perform calculations, and use repositories to interact with the database.
6.  **`src/repositories/*.ts`**: Repositories are used by services to perform CRUD (Create, Read, Update, Delete) operations on the database. They abstract the underlying data store (in this case, a PostgreSQL database).
7.  **`src/entities/*.ts`**: Entities define the structure of the data stored in the database. TypeORM uses these entities to create and manage database tables.

The response then flows back up through the layers, from the service to the controller, which sends the response to the client.

## Example: Creating an Activity

1.  A `POST` request is sent to `/api/activity`.
2.  The main router in `src/routes/index.ts` passes the request to the `ActivityRoute`.
3.  `ActivityRoute` in `src/routes/ActivityRoute.ts` matches the `POST /` endpoint and calls the `createActivity` method on an instance of `ActivityController`.
4.  The `createActivity` method in `src/controllers/ActivityController.ts` extracts the activity data from the request body and calls the static `createActivity` method on `ActivityService`.
5.  The `createActivity` method in `src/services/ActivityService.ts` creates a new `Activity` entity, populates it with the provided data, and uses `ActivityRepository` to save the new activity to the database.
6.  The service returns a success message to the controller.
7.  The controller sends a `201 Created` response to the client with the success message.
